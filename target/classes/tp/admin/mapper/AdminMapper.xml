<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="tp.admin.mapper.AdminMapper">
    <select id="memberList" resultType="Member" parameterType="MemberPagingVo">
	    <![CDATA[
	    select * from (select ROWNUM rnum , aa.* from (select * from MEMBER order by MEM_AUTH desc, MEM_STATE, MEM_EMAIL ) aa)
			 where rnum>#{startRow} and rnum<=#{endRow}
	    ]]>
 	</select>
	<select id="memberCount" resultType="int">
	    select count(MEM_EMAIL) from MEMBER
	</select>
	<select id="vipMemberList" resultType="MemberVo">
		<![CDATA[
			select aa.MEM_EMAIL, bb.MEM_NICK, aa.cnt from (select MEM_EMAIL, count(MEM_EMAIL) as cnt 
			from PAYMENT_INFO group by MEM_EMAIL order by cnt desc) aa, MEMBER bb 
			where aa.MEM_EMAIL = bb.MEM_EMAIL and rownum <= 3
		 ]]>
	</select>
	<select id="reviewMemberList" resultType="MemberVo">
		<![CDATA[
			select aa.MEM_EMAIL, bb.MEM_NICK, aa.cnt  
			from (select MEM_EMAIL, COUNT(MEM_EMAIL) as cnt from MENTORING_REVIEW group by MEM_EMAIL order by cnt desc) aa, MEMBER bb  
			where  aa.MEM_EMAIL = bb.MEM_EMAIL and rownum <= 3
		
		  ]]>
	</select>
	<select id="pointMemberList" resultType="MemberVo">
		<![CDATA[
	    select * from (select ROWNUM rnum , aa.* from (select * from MEMBER order by MEM_POINT desc) aa)
			 where rnum>0 and rnum<=3
	    ]]>
	</select>
	<select id="newMemberList" resultType="MemberVo">
		<![CDATA[
	    select * from (select ROWNUM rnum , aa.* from (select * from MEMBER order by MEM_RDATE desc) aa)
			 where rnum>0 and rnum<=3
	    ]]>
	</select>
	<select id="memberInfo" resultType="Member" parameterType="String">
		select * from MEMBER where mem_email=#{mem_email} 
	</select>
	<update id="updateN" parameterType="String">
		update MEMBER set mem_state= 2 where mem_email = #{mem_email}
	</update>
</mapper>